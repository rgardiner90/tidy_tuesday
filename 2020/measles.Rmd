---
title: "measles"
author: "Richard G. Gardiner"
date: "5/1/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)

measles <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-02-25/measles.csv')
```

```{r}
measles %>%
  distinct(state)
```


```{r}
measles %>%
  group_by(state) %>%
  summarise(average_vaccination = mean(mmr, na.rm = TRUE),
            sd = sd(mmr, na.rm = TRUE),
            lower = average_vaccination - sd,
            upper = average_vaccination + sd) %>%
  filter(average_vaccination > 0) %>% # some states have -1 as the rate.. Doesn't make any sense.
  mutate(state = fct_reorder(state, average_vaccination)) %>%
  ggplot(aes(x = state, y = average_vaccination)) +
  geom_point() +
  geom_errorbar(aes(ymin = lower, ymax = upper)) +
  labs(x = "", y = "Vaccination Rates", 
       title = "Average Vaccination Rates for Schools",
       caption = "Error Bars Indicate One Standard Deviation Above/Below") +
  coord_flip() +
  theme_minimal() 
```

```{r}
measles %>%
  count(xrel)

measles %>%
  filter(!is.na(xrel)) %>%
  group_by(state) %>%
  count(xrel)

measles %>%
  ggplot(aes(xmed)) +
  geom_histogram()

measles %>%
  ggplot(aes(xper)) +
  geom_histogram()
```

The exemptions are supposed to be percentages, but xper has a value over 100%
```{r}
summary(measles) 
```


## Analyses

3. Plot the schools. 
  - For a state that has lower rates of enrollment, plot the schools to see if there are any trends geographically within the state (is Southern California worse than Northern/Central California).
4. If there is enough variation, try to do an analysis (probably too small when aggregated to do a regression) with having ideology (Berry measure) play a role. 

